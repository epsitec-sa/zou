<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003"
         InitialTargets="PackTrace">
  
  <PropertyGroup>
    <PkgSourceDir Condition="'$(PkgSourceDir)' == ''">$(OutDir)</PkgSourceDir>
  </PropertyGroup>
  <!-- Default includes and excludes for package builder -->
  <ItemGroup>
    <ProdBinInclude Include="$(PkgSourceDir)**\*" />
    <ProdBinExclude Include="$(PkgSourceDir)**\*.pdb" />
    <ProdBinExclude Include="$(PkgSourceDir)**\*.map" />
    <ProdBinExclude Include="$(PkgSourceDir)**\*.lib" />
    <ProdBinExclude Include="$(PkgSourceDir)**\*.exp" />
    <ProdBinExclude Include="$(PkgSourceDir)**\*.bsc" />
    <ProdBinExclude Include="$(PkgSourceDir)**\*.ilk" />

    <ProdDbgInclude Include="$(PkgSourceDir)**\*.pdb" />
    <ProdDbgInclude Include="$(PkgSourceDir)**\*.map" />
    <ProdDbgInclude Include="$(DbgDir)**\*.cod" Condition="'$(DbgDir)' != ''" />

    <DevBinInclude Include="$(PkgSourceDir)**\*" />
    <DevCodInclude Include="$(DbgDir)**\*.cod" Condition="'$(DbgDir)' != ''" />
  </ItemGroup>

  <!-- Package builder -->
  <ItemGroup>
    <!-- Production package -->
    <ImportFile Include="@(ProdBinInclude)" Exclude="@(ProdBinExclude)">
      <ImportDir>$(PkgProdBinDir)</ImportDir>
    </ImportFile>
    <ImportFile Include="@(ProdDbgInclude)">
      <ImportDir>$(PkgProdDbgDir)</ImportDir>
    </ImportFile>

    <!-- Developer package -->
    <ImportFile Include="@(DevBinInclude)">
      <ImportDir>$(PkgDevBinDir)</ImportDir>
    </ImportFile>
    <ImportFile Include="@(DevCodInclude)">
      <ImportDir>$(PkgDevDbgDir)</ImportDir>
    </ImportFile>
  </ItemGroup>

  <Import Project="ImportFile.targets" />

  <Target Name="PackTrace">
    <Message Text="PkgSourceDir = $(PkgSourceDir)" />
  </Target>
</Project>