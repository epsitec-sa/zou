<!-- Defines the default metadata for .NET projects (epilog) -->
<Project  InitialTargets="TraceDirectoryBuildDefaultTargets">
  <PropertyGroup>
    <!-- Package default properties -->
    <AssemblyTitle Condition="'$(AssemblyTitle)' == ''">$(AssemblyName)</AssemblyTitle>
    <AssemblyTitle>$(AssemblyTitle) ($(TargetFramework))</AssemblyTitle>
    <FirstCopyrightYear Condition="'$(FirstCopyrightYear)' == ''"></FirstCopyrightYear>
    <LastCopyrightYear Condition="'$(LastCopyrightYear)' == ''">$([System.DateTime]::Now.ToString(yyyy))</LastCopyrightYear>
    <CopyrightYears Condition="'$(CopyrightYears)' == '' And ('$(FirstCopyrightYear)' == '' Or '$(FirstCopyrightYear)' == '$(LastCopyrightYear)')">$(LastCopyrightYear)</CopyrightYears>
    <CopyrightYears Condition="'$(CopyrightYears)' == ''">$(FirstCopyrightYear)-$(LastCopyrightYear)</CopyrightYears>
    <Copyright Condition="'$(Copyright)' == ''">Copyright Â© $(CopyrightYears), EPSITEC SA, CH-1400 Yverdon-les-Bains, Switzerland</Copyright>
    <Authors Condition="'$(Authors)' == ''">$(Company)</Authors>
    <Product Condition="'$(Product)' == ''">$(AssemblyName)</Product>
    <Description Condition="'$(Description)' == ''">$(Product) v$(Version) ($(TargetFramework))</Description>
    <DefaultLanguage Condition="'$(DefaultLanguage)' == ''">en-US</DefaultLanguage>
    <PackageId Condition="'$(PackageId)' == ''">$(ProjectName)</PackageId>
    <PackageId Condition="!$(PackageId.StartsWith('$(Company)'))">$(Company).$(PackageId)</PackageId>
    <DefaultPackageTags>$(PackageId.Replace('.', ';'))</DefaultPackageTags>
    <PackageTags Condition="'$(PackageTags)' != ''">$(DefaultPackageTags);$(PackageTags)</PackageTags>
    <PackageTags Condition="'$(PackageTags)' == ''">$(DefaultPackageTags)</PackageTags>
    <PackageTags >$(PackageTags.ToLower())</PackageTags>
    <RepositoryType Condition="'$(RepositoryType)' == ''">git</RepositoryType>
    <RepositoryUrl Condition="'$(RepositoryUrl)' == '' And '$(PackageProjectUrl)' != ''">$(PackageProjectUrl).$(RepositoryType)</RepositoryUrl>

    <!-- Suppress following C# warning because we use a subset of the semantic versioning format - major.minor.patch -->
    <!-- warning CS7035: The specified version string does not conform to the recommended format - major.minor.build.revision -->
    <NoWarn>$(NoWarn);7035</NoWarn>
    <!-- Suppress following C# warning because we use a a preview of C# 8.0 (VS 2019 and .NET Core 3.0 previews) -->
    <!-- warning CS8632: The annotation for nullable reference types should only be used in code within a '#nullable' context. -->
    <NoWarn>$(NoWarn);8632</NoWarn>

  </PropertyGroup>

  <!-- TargetFrameworks -->
  <!-- Do not set TargetFrameworks when running inside Visual Studio -->
  <PropertyGroup Condition="'$(TargetFrameworks)' == '' And '$(BuildingInsideVisualStudio)' == ''">
    <TargetFrameworks>$(FullTargetFramework);$(CoreTargetFramework);netstandard2.0;netstandard2.1</TargetFrameworks>
  </PropertyGroup>
  
  <!-- Exclude git metadata from project -->
  <ItemGroup>
    <None Remove=".git*" />
  </ItemGroup>

  <!-- Make assembly internals visible to test projects (MyProject visible to MyProject.Test[s]) -->
  <!-- Does not support signed assemblies -->
  <Target Name="AddInternalsVisibleToAttribute" BeforeTargets="GetAssemblyAttributes" Condition="!$(SignAssembly)">
    <ItemGroup>
      <AssemblyAttribute Include="System.Runtime.CompilerServices.InternalsVisibleTo">
        <_Parameter1>$(MSBuildProjectName).Test</_Parameter1>
      </AssemblyAttribute>
      <AssemblyAttribute Include="System.Runtime.CompilerServices.InternalsVisibleTo">
        <_Parameter1>$(MSBuildProjectName).Tests</_Parameter1>
      </AssemblyAttribute>
    </ItemGroup>
  </Target>

  <Target Name="TraceDirectoryBuildDefaultTargets" Condition="'$(ZouTrace)' == 'true'">
    <Message Importance="high" Text=" TargetFramework           = $(TargetFramework)" />
    <Message Importance="high" Text=" TargetFrameworks          = $(TargetFrameworks)" />
    <Message Importance="high" Text=" TargetFrameworkIdentifier = $(TargetFrameworkIdentifier)" />
    <Message Importance="high" Text=" TargetFrameworkVersion    = $(TargetFrameworkVersion)" />
  </Target>
</Project>
