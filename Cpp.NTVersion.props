<?xml version="1.0" encoding="utf-8"?>
<!-- This property sheet resolves the 'NTVersion'property and C++ '_WIN32_WINNT' macro (supports override in zou.cfg folder). -->
<Project ToolsVersion="4.0" InitialTargets="CppNTVersionTrace" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Import Condition="'$(Zou)' == ''" Project="zou.props" />

  <ImportGroup Label="PropertySheets">
    <Import Project="$(ZouBundleDir)**\$(MSBuildThisFileName)*$(MSBuildThisFileExtension)"   Condition="'$(ZouBundleDir)'   != ''" />
    <Import Project="$(ZouSolutionDir)**\$(MSBuildThisFileName)*$(MSBuildThisFileExtension)" Condition="'$(ZouSolutionDir)' != '' And '$(ZouSolutionDir)' != '$(ZouBundleDir)'" />
    <Import Project="$(ZouProjectDir)**\$(MSBuildThisFileName)*$(MSBuildThisFileExtension)"  Condition="'$(ZouProjectDir)'  != '' And '$(ZouProjectDir)'  != '$(ZouSolutionDir)' And '$(ZouProjectDir)' != '$(ZouBundleDir)'" />
    <Import Project="$(ZouPrivateDir)$(MSBuildThisFileName).Default$(MSBuildThisFileExtension)" Condition="'$(NTVersion)' == ''" />
  </ImportGroup>

  <Choose>
    <When Condition="'$(NTVersion)' == '0x601'">
      <PropertyGroup>
        <_PropertySheetDisplayName>[zou] NTVersion = _WIN32_WINNT = 0x601 (Windows 7)</_PropertySheetDisplayName>
      </PropertyGroup>
    </When>
    <When Condition="'$(NTVersion)' == '0x600'">
      <PropertyGroup>
        <_PropertySheetDisplayName>[zou] NTVersion = _WIN32_WINNT = 0x600 (Windows Vista)</_PropertySheetDisplayName>
      </PropertyGroup>
    </When>
    <When Condition="'$(NTVersion)' == '0x502'">
      <PropertyGroup>
        <_PropertySheetDisplayName>[zou] NTVersion = _WIN32_WINNT = 0x502 (Windows Server 2003)</_PropertySheetDisplayName>
      </PropertyGroup>
    </When>
    <When Condition="'$(NTVersion)' == '0x501'">
      <PropertyGroup>
        <_PropertySheetDisplayName>[zou] NTVersion = _WIN32_WINNT = 0x501 (Windows XP)</_PropertySheetDisplayName>
      </PropertyGroup>
    </When>
    <When Condition="'$(NTVersion)' == '0x500'">
      <PropertyGroup>
        <_PropertySheetDisplayName>[zou] NTVersion = _WIN32_WINNT = 0x500 (Windows 2000)</_PropertySheetDisplayName>
      </PropertyGroup>
    </When>
    <Otherwise>
      <PropertyGroup>
        <_PropertySheetDisplayName>[zou] NTVersion = _WIN32_WINNT = ...</_PropertySheetDisplayName>
      </PropertyGroup>
    </Otherwise>
  </Choose>

  <ItemDefinitionGroup>
    <ClCompile>
      <PreprocessorDefinitions>_WIN32_WINNT=$(NTVersion);%(PreprocessorDefinitions)</PreprocessorDefinitions>
    </ClCompile>
  </ItemDefinitionGroup>

  <Target Name="CppNTVersionTrace">
    <Message Text="_WIN32_WINNT = NTVersion = $(NTVersion)" />
  </Target>
</Project>