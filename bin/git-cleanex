#!/bin/bash

. zoul-git-repo

while [[ "$#" > 0 ]]; do case "$1" in
  -h|--help) zou-help $0; exit 0;;
  -d|--rdsm) removeDanglingSubmodules=true;;
  -*) echo "unknown option: $1" >&2; exit 1;;
esac; shift; done

repo_require_clean_work_tree 'cannot clean' || exit 1
[[ $removeDanglingSubmodules == true ]] && {
  io_info 'removing dangling submodules...' "[$(repo_module_id)]"
  repo_remove_dangling_submodules
}

[ -d node_modules ] && {
  io_info 'removing node modules...' "[$(repo_module_id)]"
  rm -rf node_modules
}
git clean -xdf -e packages
git checkout .
