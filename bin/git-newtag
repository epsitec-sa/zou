#! /bin/bash

. zoul-core

args=()
while [[ "$#" > 0 ]]; do case "$1" in
  -h|--help) zou-help $0; exit 0;;
  --debug)  debug=true;;
  --local)  local=true;;
  -m|--message) message=$2; shift;;
  -*) io_error "unknown option: $1"; exit 1;;
  *) args+=("$1");;
esac; shift; done

tag="${args[0]}"
commit="${args[1]:-HEAD}"

io_debug tag
io_debug commit

[[ -z $message ]] && message=$(git log -1 --pretty=%B "$commit")

git tag -a -m "'$message'" "$tag" "$commit"
[[ $local == true ]] || git push $(git remote) "$tag"
