#!/bin/bash

# General references
# https://www.davidpashley.com/articles/writing-robust-shell-scripts/

# Use '. zoul' to (re)load zoul-* libraries

while [[ "$#" > 0 ]]; do case "$1" in
  -h|--help)
    echo "zoul [<options>] - Load zou libraries.

      -h|--help            display help
      -z|--zou-vars        display zou variables
      --debug              display debug info"
    exit 0;;
  -z|--zou-vars) showZouVars=true;;
  --debug)       debug=true;;
  -*) echo "unknown option: $1" >&2; exit 1;;
esac; shift; done

unset ZOUL_CORE
unset ZOUL_LOCK
unset ZOUL_CONFIG
unset ZOUL_PROCESS
unset ZOUL_GIT_CORE
unset ZOUL_GIT_REPO
unset ZOUL_GIT_REF
unset ZOUL_GIT_TAG
unset ZOUL_GIT_VTAG
unset ZOUL_GIT_VTABLE
unset ZOUL_GIT_COMMIT
unset ZOUL_GIT_VBRANCH
unset ZOUL_GIT_CONFIG_PUBLISH
unset ZOUL_GIT_CONFIG_SELECT
unset ZOUL_GIT_CONFIG_SKU
unset ZOUL_GIT_CONFIG_VERSION
unset ZOUL_GIT_BRANCH_CORE
unset ZOUL_GIT_BRANCH_MERGE
unset ZOUL_GIT_BRANCH_SYNC
unset ZOUL_GIT_BRANCH_SELECT
unset ZOUL_GIT_BRANCH_PUBLISH

. zoul-core
. zoul-lock
. zoul-config
. zoul-process
. zoul-git-core
. zoul-git-repo
. zoul-git-ref
. zoul-git-tag
. zoul-git-vtag
. zoul-git-vtable
. zoul-git-commit
. zoul-git-vbranch
. zoul-git-config-publish
. zoul-git-config-select
. zoul-git-config-sku
. zoul-git-config-version
. zoul-git-branch-core
. zoul-git-branch-merge
. zoul-git-branch-sync
. zoul-git-branch-select
. zoul-git-branch-publish

if [[ $showZouVars == true ]]; then
  for zouVar in $(compgen -v | grep -Ei '^(zou|io)_'); do
    declare -p $zouVar
  done
fi