#!/bin/bash

# Use the following statement to include current lib only once
#   [[ -z $ZOUL_CONFIG ]] && . zoul-config
ZOUL_CONFIG=true

[[ -z $ZOUL_CORE ]] && . zoul-core

config_reset() { git config --global --unset 'zou.initialized'; }

config_setup()
{
  [[ $(git config --global 'zou.initialized') == true ]] || {

    [ -f $(realPath ~/.gitconfig) ] && cp -f "$(realPath ~/.gitconfig)" "$(realpath ~/.gitconfig.backup)"

    # setup default credential helper (save credentials in ~/.git-credentials)
    ! git config credential.helper &>/dev/null && git config --global credential.helper store
    
    git config --global --remove-section status &>/dev/null
    git config --global --remove-section diff &>/dev/null
    git config --global --remove-section alias &>/dev/null

    # Semantic versioning
    git config --global --remove-section versionsort &>/dev/null
    git config --global --add versionsort.suffix -@
    git config --global --add versionsort.suffix -alpha
    git config --global --add versionsort.suffix -beta
    git config --global --add versionsort.suffix -rc

    git config --global zou.initialized true
  }

  git config --global push.followTags true

  # update zou aliases
  git config --global --unset alias.csku
  git config --global --unset alias.csel
  git config --global --unset alias.cver
  git config --global --unset alias.cpub
  git config --global --unset alias.smaster
  git config --global --unset alias.spull
  git config --global --unset alias.sclean

  git config --global --add alias.csku 'config-sku'
  git config --global --add alias.csel 'config-select'
  git config --global --add alias.cver 'config-version'
  git config --global --add alias.cpub 'config-publish'
  git config --global --add alias.smaster 'git-select --dev master'
  git config --global --add alias.spull 'git-sync --nopush'
  git config --global --add alias.sclean 'git-cleanex'
}
