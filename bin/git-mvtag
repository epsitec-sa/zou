#!/bin/bash

. zoul-git-tag

args=()
while [[ "$#" > 0 ]]; do case "$1" in
  -h|--help) zou-help $0; exit 0;;
  --) args+=( "$@" ); break;;
  --debug) debug=true;;
  -*) io_error "unknown option: $1"; exit 1;;
  *) args+=("$1");;
esac; shift; done

tag1="${args[0]}"
tag2="${args[1]}"

if tag_exists $tag1; then
  tag_move "$tag1" "$tag2"
else
  # assume tag1 and tag2 are tag prefix (folders)
  for tag in $(git tag -l); do
    if [[ $tag =~ ^${tag1%/}(/[^/]+$) ]]; then
      tag_move $tag ${tag2%/}${BASH_REMATCH[1]}
    fi
  done
fi
