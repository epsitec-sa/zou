#!/bin/bash

[[ -z $ZOUL_CONFIG ]]     && . zoul-config
[[ -z $ZOUL_GIT_MODULE ]] && . zoul-git-module

zou_parse()
{
  while [[ "$#" > 0 ]]; do case "$1" in
    -z|--zou-only) zouOnly=true;;
    *)             selectArgs+=($1);;
  esac; shift; done
}

zou_update()
{
  local resetConfig zouOnly selectArgs=()
  zou_parse "$@"
  
  config_setup

  if [[ $zouOnly == true || "$bundleRoot" == "$PWD" ]]; then
    # zou repo alone, fetch has already been done
    . git-select "${selectArgs[@]}"
  else
    # zou repo inside zou-dev bundle, synchronize and select all
    cd "$bundleRoot"
    . git-sync
    . git-select "${selectArgs[@]}"
  fi

  io_warning "Update finished, press the [Enter] key." "$moduleTracePrefix"
}

module_run zou_update "$@"
