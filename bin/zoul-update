#!/bin/bash

while [[ "$#" > 0 ]]; do case "$1" in
  -r|--reset) resetConfig=true;;
  -f|--fast)  fast=true;;
  -*) echo "unknown option: $1" >&2; exit 1;;
esac; shift; done

[[ -z $ZOUL_GIT_REPO ]] && . zoul-git-repo
[[ -z $ZOUL_CONFIG ]]   && . zoul-config

zou_update()
{
  [[ $resetConfig == true ]] && config_reset
  config_setup

  local broot=$(repo_bundle_root)

  if [[ $fast == true || "$broot" == "$PWD" ]]; then
    # zou repo alone, fetch has already been done
    git select -q wip/git-commands
  else
    # zou repo inside zou-dev bundle, synchronize and select all
    local opwd=$PWD
    cd "$broot"
    git sync -q
    git select -q wip/zou/git-commands
    cd "$opwd"
  fi
}

zou_update